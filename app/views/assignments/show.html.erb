<div ng-controller="submissionsCtrl" ng-init="setup(<%= params[:id] %>, <%= @student.id %>)">
  <div class="row row-margin">
    <div class="col-md-2">
      <div class="white">
        <%= link_to "Assignment List", "/assignments/?student_id=#{@student.id}" %>
      </div>
    </div>
    <div class="col-md-10">
      <div class="white">
        <h2>Exercise: <%= @assignment.title %></h2>
          <% if @assignment.youtube_id.present? %>
            <p>Please watch the video to complete the exercise below.</p>
            <div class="embed-container">
              <iframe src="//www.youtube.com/embed/<%= @assignment.youtube_id %>"></iframe> 
            </div>
          <% end %>
        <div>
          <pre>
            <%= @assignment.question %>
          </pre>
        </div>
        <%= link_to "Edit", "/assignments/#{@assignment.id}/edit?student_id=#{@student.id}", class: "btn btn-warning" if current_user.instructor_or_administrator %>
      </div>

      <div class="white">
        <h2>Solution</h2>
        <tabset justified="true">
          <tab heading="Solution">
            <pre>
              <pre>{{ lastSubmission.answer }}</pre>
            </pre>
          </tab>
          <tab heading="Submit/Update Solution">
            <div>
              <pre>{{ lastSubmission.answer }}</pre>
            </div>
            <textarea ng-model="submissionText" class="form-control submission-box"></textarea>
            <button ng-click="submitText(submissionText)" class="btn btn-primary"> Submit / Update Text</button>
          </tab>
          <tab heading="History">
            <div ng-repeat="submission in submissions">
              <pre>{{ submission.answer }}</pre>
              <div class="submitted-date">
                Submitted {{ submission.created_at}}
              </div>
            </div>
          </tab>
        </tabset>
      </div>
      <div class="white">
        <h2>Comments</h2>
          <div ng-repeat="comment in comments">
            <div class="row comments">
              <div class="col-md-3 author-info" ng-class="comment.user.role_id === 2 ? 'instructor-class' : 'not-instructor-class'">
                <div> <span ng-if="comment.user.role_id === 2">Instructor: </span> {{ comment.user.email }}</div>
                <div>{{ comment.created_at }} </div>
              </div>
              <div class="col-md-9">
                <div class="comment-box">
                  {{ comment.text }}
                </div>
              </div>
            </div>
          </div>
        <textarea ng-model="commentText" class="form-control"></textarea>
        <button ng-click="submitCommentText(commentText)" class="btn btn-primary"> Leave Comment</button>
      </div>
    </div>
  </div>
</div>
